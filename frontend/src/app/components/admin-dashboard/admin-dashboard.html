<div class="container-fluid" style="max-width: 1400px; margin: 0 auto; padding: 2rem 3rem;">
  <div class="row mb-4 align-items-center">
    <div class="col-md-8">
      <h2 class="fw-bold text-dark"><i class="bi bi-speedometer2 me-2"></i>Dashboard Admin</h2>
      <p class="text-muted mb-0">Vista global de usuarios y facturas registradas en la base de datos.</p>
      <small class="text-muted" *ngIf="lastUpdate">Actualizado: {{ lastUpdate | date:'shortTime' }}</small>
    </div>
    <div class="col-md-4 text-md-end mt-3 mt-md-0">
      <button class="btn btn-success shadow-sm px-4" (click)="refreshDashboard()">
        <i class="bi bi-arrow-clockwise me-2"></i>Recargar
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="alert alert-info">Cargando estadisticas...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <div *ngIf="!loading" class="row g-4 mb-4">
    <div class="col-md-4">
      <div class="card kpi-card border-0 shadow-sm p-4 text-center bg-white h-100">
        <div class="kpi-icon mx-auto bg-primary-subtle text-primary mb-3"><i class="bi bi-people-fill"></i></div>
        <span class="text-muted small fw-bold">USUARIOS REGISTRADOS</span>
        <h2 class="fw-bold mb-0 mt-2">{{ usuarios }}</h2>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card kpi-card border-0 shadow-sm p-4 text-center bg-white h-100">
        <div class="kpi-icon mx-auto bg-primary-subtle text-primary mb-3"><i class="bi bi-tags-fill"></i></div>
        <span class="text-muted small fw-bold">TIPOS DE GASTO</span>
        <h2 class="fw-bold mb-0 mt-2">{{ porGasto.length }}</h2>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card kpi-card border-0 shadow-sm p-4 text-center bg-white h-100">
        <div class="kpi-icon mx-auto bg-primary-subtle text-primary mb-3"><i class="bi bi-calendar-event-fill"></i></div>
        <span class="text-muted small fw-bold">DIAS CON ACTIVIDAD</span>
        <h2 class="fw-bold mb-0 mt-2">{{ porDia.length }}</h2>
      </div>
    </div>
  </div>

  <div *ngIf="!loading" class="row g-4">
    <div class="col-lg-4">
      <div class="card border-0 shadow-sm rounded-4 h-100">
        <div class="card-header bg-white py-3 border-bottom">
          <h5 class="mb-0 fw-bold">Facturas por Tipo de Gasto</h5>
        </div>
        <div class="card-body">
          <div *ngIf="porGasto.length === 0" class="text-muted">Sin datos.</div>
          <canvas *ngIf="porGasto.length > 0" baseChart [data]="barChartData" [options]="barChartOptions" [type]="barChartType"></canvas>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card border-0 shadow-sm rounded-4 h-100">
        <div class="card-header bg-white py-3 border-bottom">
          <h5 class="mb-0 fw-bold">Facturas por Dia (ultimos 30 dias)</h5>
        </div>
        <div class="card-body">
          <div *ngIf="porDia.length === 0" class="text-muted">Sin datos.</div>
          <canvas *ngIf="porDia.length > 0" baseChart [data]="lineChartData" [options]="lineChartOptions" [type]="lineChartType"></canvas>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card border-0 shadow-sm rounded-4 h-100">
        <div class="card-header bg-white py-3 border-bottom">
          <h5 class="mb-0 fw-bold">Distribucion por Tipo</h5>
        </div>
        <div class="card-body">
          <div *ngIf="porGasto.length === 0" class="text-muted">Sin datos.</div>
          <canvas *ngIf="porGasto.length > 0" baseChart [data]="doughnutChartData" [options]="doughnutChartOptions" [type]="doughnutChartType"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>
